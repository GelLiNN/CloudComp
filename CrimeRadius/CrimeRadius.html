<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Crime in your vicinity!</title>
    <link href="QSstyle.css" type="text/css" rel="stylesheet" />
</head>
<body>
    <div id="main">
        <h1>Crime within inputted radius</h1>
        <input type="text" id="lat" size="20" placeholder="Latitude" />
        <input type="text" id="long" size="20" placeholder="Longitude" />
        <input type="text" id="rad" size="20" placeholder="Radius (Miles)" />
        <input type="submit" value="Get Crime!" onclick="sendJson()"></input>
        <p id="results">
        </p>
    </div>
    <script src="https://code.jquery.com/jquery-2.1.4.js" type="text/javascript"></script>
    <script type="text/javascript">
        function sendJson() {
            var lat = document.getElementById('lat').value;
            var long = document.getElementById('long').value;
            var radius = parseInt(document.getElementById('rad').value);
            var radiusMeters = radius * 1609;
            //1609 Meters in a mile

            document.getElementById('results').innerHTML = "Latitude: " + lat +
                "\n" + "Longitude: " + long + "\n" + "Radius: " + radiusMeters;

            $.ajax({
                url: "https://data.seattle.gov/resource/pu5n-trf4.json",
                type: "GET",
                data: {
                    "$limit" : 50,
                    "$where" : "within_circle(incident_location, "
                        + lat + ", " + long + ", "+ radiusMeters + ")"
                }
            }).done(function(data) {
                alert("Retrieved " + data.length + " records from the dataset!");
                //console.log(data);
                document.getElementById('results').innerHTML = JSON.stringify(data);
            });
        }
    </script>

</body>
</html>
